$(function(){getMyHomePage(1);addInfo()});function getInfo(){return localStorage.getItem("Authorization")}function getMyHomePage(page){if(null==page||page<1){page=1}var pagesize=6;$.ajax({type:"post",url:"../base/insForumPageInfo",dataType:"json",data:{"userid":$("#userid").val(),"pagesize":pagesize},success:function(data){}})}function addInfo(){var uname=$("#uname").val();var uid=$("#userid").val();var info=localStorage.getItem("Authorization");$("a[name='toEdit']").attr("href","../user/toEditMe?uname="+uname+"&uid="+uid+"&info="+info);$("a[name='mycomment']").attr("href","../user/myComment?uid="+uid+"&uname="+uname+"&info="+info);$("#myforuma").attr("href","../user/myHome?uid="+uid+"&uname="+uname+"&info="+info);var totalpage=$("#totalpage").val();var currentpage=$("#currentpage").val();if(null!=totalpage&&totalpage>0){for(var i=1;i<=totalpage;i++){if(i==currentpage){$("#pageul").append(" <li class='am-active'><a href='../user/myFriend?info="+info+"&currentpage="+i+"' name='pagelink'>"+i+"</a></li>")}else{$("#pageul").append(" <li class=''><a href='../user/myFriend?info="+info+"&currentpage="+i+"' name='pagelink'>"+i+"</a></li>")}}}}function showMyCollect(page){var info=getInfo();var uid=$("#userid").val();if(null==page||page<1){page=1}if(null!=info){$.ajax({type:"post",url:"../jwt/getCollectForum",contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:info},data:JSON.stringify({"currentpage":page,"userid":uid}),success:function(resp){if(resp.list.length<1){$("#forumdiv").empty();$("#someinfo").html("我的收藏");$("#forumdiv").append("<h3 class='text-danger'>未找到有关记录,先去收藏一个</h3>")}else{$("#forumdiv").empty();for(var i=0;i<resp.list.length;i++){var ucf=resp.list[i];$("#forumdiv").append("<article class='am-g blog-entry-article'><div class='am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-img'><img src='../images/"+ucf.image+"'alt=''class='am-u-sm-12'></div><div class='am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-text'><span><a href='../ins/"+ucf.institutionid+"'class='blog-color'>"+ucf.institutionname+"&nbsp;</a></span><span><a href='../user/otherUser?uid="+ucf.authorid+"&info="+info+"'>@--"+ucf.authorname+"&nbsp;</a></span><span>"+ucf.createtime+"</span><br><strong><a href='../p/"+ucf.forumid+"'>"+ucf.title+"</a></strong><p>"+ucf.description+"</p><p><a href=''class='blog-continue'>continue reading</a></p></div></article>");$("#someinfo").html("我的收藏")}}}})}}function showsendrequest(page){var info=getInfo();var uid=$("#userid").val();if(null!=info){$.ajax({type:"post",url:"../jwt/findSend",contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:info},data:JSON.stringify({"currentpage":page,"userid":uid}),success:function(resp){if(resp.list!=null&&resp.list!=undefined&&resp.list.length<1){$("#forumdiv").empty();$("#forumdiv").append("<h3 class='text-danger'>未找到有关记录</h3>")}else{$("#forumdiv").empty();$("#someinfo").html("我发送请求");for(var i=0;i<resp.list.length;i++){var list=resp.list[i];if(list.isfriend==true){$("#forumdiv").append("<div class='col-md-6' style='height:600px'><div class='panel panel-default'><span>发送时间</span><strong>"+list.createtime+"</strong><div class='panel-body'><img style='width: 100% \9;' class='img-responsive img-thumbnail' src='../images/"+list.image+"'><p><strong><a href='#'>"+list.username+"</a></strong></p><span class='text-danger'>"+list.signature+"</span><br><button class='btn btn-success' onclick='updatesnedfriend(\""+list.id+"\")' > 已通过</button><span>通过时间</span><strong>"+list.admittime+"</strong><p>第一句话:"+list.request+"</p></div></div></div>")}else{$("#forumdiv").append("<div class='col-md-6' style='height:600px'><div class='panel panel-default'><span>发送时间</span><strong>"+list.createtime+"</strong><div class='panel-body'><img style='width: 100% \9;' class='img-responsive img-thumbnail' src='../images/"+list.image+"'><p><strong><a href='#'>"+list.username+"</a></strong></p><span class='text-danger'>"+list.signature+"</span><br><button class='btn btn-warning'  >未通过</button><p>第一句话:"+list.request+"</p></div></div></div>")}}}}})}}function showgetrequest(page){var info=getInfo();var uid=$("#userid").val();if(null!=info){$.ajax({type:"post",url:"../jwt/findGet",contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:info},data:JSON.stringify({"currentpage":page,"userid":uid}),success:function(resp){if(resp.list!=null&&resp.list!=undefined&&resp.list.length>0){$("#forumdiv").empty();$("#someinfo").html("我收到的请求");for(var i=0;i<resp.list.length;i++){var list=resp.list[i];var ii=list.id;if(list.isfriend==true){$("#forumdiv").append("<div class='col-md-6' style='height:600px'><div class='panel panel-default'><span>发送时间</span><strong>"+list.createtime+"</strong><div class='panel-body'><img style='width: 100% \9;' class='img-responsive img-thumbnail' src='../images/"+list.image+"'><p><strong><a href='#'>"+list.username+"</a></strong></p><span class='text-danger'>"+list.signature+"</span><br><button class='btn btn-success' onclick='updategetfriend(\""+list.id+"\")' >已通过</button><span>通过时间</span><strong>"+list.admittime+"</strong><p>第一句话:"+list.request+"</p></div></div></div>")
    }else{$("#forumdiv").append("<div class='col-md-6' style='height:600px'><div class='panel panel-default'><span>发送时间</span><strong>"+list.createtime+"</strong><div class='panel-body'><img style='width: 100% \9;' class='img-responsive img-thumbnail' src='../images/"+list.image+"'><p><strong><a href='#'>"+list.username+"</a></strong></p><span class='text-danger'>"+list.signature+"</span><br><button class='btn btn-warning'  onclick='admitfriend(\""+list.id+"\")' >未通过</button><p>第一句话:"+list.request+"</p></div></div></div>")}}}else{$("#forumdiv").empty();$("#forumdiv").append("<h3 class='text-danger'>未找到有关记录</h3>")}}})}}var isf=false;function updategetfriend(id){$("#confirmbutton").click();$("#opfriend").html("是否解除好友关系");$("#confimedit").val(1);$("#opfriend").val(id)}function updatesnedfriend(id){$("#confirmbutton").click();$("#opfriend").html("是否解除好友关系");$("#confimedit").val(0);$("#opfriend").val(id)}function admitfriend(id){isf=true;$("#confirmbutton").click();$("#opfriend").html("是否确定好友关系");$("#confimedit").val(1);$("#opfriend").val(id)}function updatefriend(obj){var info=getInfo();var fla=$("#confimedit").val();var id=$("#opfriend").val();if(fla==0){$.ajax({type:"post",url:"../jwt/updatesendFriend",contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:info},data:JSON.stringify({"id":id,"is_friend":isf,}),success:function(resp){if(resp.code==1){$("#okbutton").click();$("#resultbutton").click();$("#opresult").html("已修改")}else{$("#opfriend").html(resp.msg)}}})}else{$.ajax({type:"post",url:"../jwt/updategetFriend",contentType:"application/json;charset=utf-8",dataType:"json",headers:{Authorization:info},data:JSON.stringify({"id":id,"is_friend":isf,}),success:function(resp){if(resp.code==1){$("#okbutton").click();$("#resultbutton").click();$("#opresult").html("已修改")}else{$("#opfriend").html(resp.msg)}}})}}function showMenu(){document.getElementById("dropMenu").style.display="block"}function hideMenu(){document.getElementById("dropMenu").style.display="none"}function logOut(){localStorage.removeItem("Authorization");$.ajax({type:"post",url:"../logout",success:function(){window.location.href="../logout"}})}function logOut(){localStorage.removeItem("Authorization");$.ajax({type:"post",url:"../logout",success:function(){window.location.href="../"}})};