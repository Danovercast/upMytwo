<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>$user.username的主页</title>
    <link rel="stylesheet" href="../css/amazeui.min.css">
    <link rel="stylesheet" href="../css/app.css">
    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">


    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
</head>
<body>
<input type="hidden" value="$user.username" id="uname">
<input type="hidden" id="userid" value="$user.user_id" >
<nav class="navbar navbar-default navbar-fixed-top" >
    <div class="container">
        <div class="navbar-header">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a class="navbar-brand" href="../html/index.html">主页</a>
                </li>
            </ul>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="#"></a></li>
                <li><a href="../html/index.html">首页</a></li>
                <li><a href="#contact">学习</a></li>
                <li><a href="#contact">论坛</a></li>

            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../navbar/">游戏</a></li>
                <li><a href="../navbar/">交友</a></li>
                <li><a href="../navbar-static-top/">动漫</a></li>
                <li class="dropdown">
                    <a href="#" class="downshow" onmouseover="showMenu()" role="button" aria-haspopup="true"
                       aria-expanded="false">$user.username <span class="caret"></span></a>
                    <ul class="dropdown-menu" onmouseleave="hideMenu()" id="dropMenu"
                        style="display: none;">
                        <li ><a href="#">个人中心</a></li>
                        <li><a name="toEdit" href="">修改信息</a></li>
                        <li><a href="../ins/$user.institution_id">学院</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">其他</li>
                        <li><a   name="mycomment">我的评论</a></li>
                        <li><a href="#" onclick="logout()">退出登陆</a></li>
                    </ul>
                </li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<!-- 功能模块 -->
<div class="row div_function" style="margin-top: 70px">
    <div class="col-xs-1">
    </div>
    <div class="col-xs-9">
        <div class="panel panel-default" >
            <div class="panel-body">
                <strong>上次时间</strong>

            </div>
        </div>
    </div>
    <div class="col-xs-1">
        
    </div>

</div>
<div class="container div_divider">
    <!-- 分割线 -->
    <hr>
    <nav class="am-g am-g-fixed blog-fixed blog-nav">
        <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only blog-button" data-am-collapse="{target: '#blog-collapse'}" ><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>

        <div class="am-collapse am-topbar-collapse" id="blog-collapse">
            <ul class="am-nav am-nav-pills am-topbar-nav">
                <li class="am-active"><a href="../html/index.html">首页</a></li>
                <li class="am-dropdown" data-am-dropdown>
                    <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
                        我在论坛 <span class="am-icon-caret-down"></span>
                    </a>
                    <ul class="am-dropdown-content">
                        <li><a href="#" id="myforuma">我的帖子</a></li>
                        <li><a href="#"  name="mycomment">我的评论</a></li>
                        <li><a href="lw-index-center.html">我的好友</a></li>
                        <li><a href="#"  onclick="showMyCollect(1)"   id="mycollect">我的收藏</a></li>
                    </ul>
                </li>
                <li><a name="toEdit"  >修改信息</a></li>
                  <li class="am-dropdown" data-am-dropdown>
                    <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
                        请求 <span class="am-icon-caret-down"></span>
                    </a>
                    <ul class="am-dropdown-content">
                        <li><a href="#" id="myforuma">发送的请求</a></li>
                        <li><a href="lw-index-center.html">收到的请求</a></li>
                    </ul>
                </li>
                <li><a href="随笔.html">我的随笔</a></li>
            </ul>
            <form class="am-topbar-form am-topbar-right am-form-inline" role="search">
                <div class="am-form-group">
                    <input type="text" class="am-form-field am-input-sm" placeholder="搜索">
                    <button class="btn btn-info">search</button>
                </div>
            </form>
        </div>
    </nav>
    <hr>
    <div class="row">
        <div class="col-xs-9">
            <div class="list-group div_article">
                <!-- 子头栏 -->
                <a href="#" class="list-group-item active item_article_first">
                    <h4 class="list-group-item-heading panel-success text-center" id="someinfo">
                        我的好友
                    </h4>
                </a>
                <div id="forumdiv">
              <div class="row " style="margin-top: 70px">
    <div class="col-xs-1">
    </div>
    <div class="col-xs-5">
        <div class="panel panel-default" >
            <div class="panel-body">
                <strong>上次时间</strong>

            </div>
        </div>
    </div>
    <div class="col-xs-5">
        <div class="panel panel-default" >
            <div class="panel-body">
            <img class="img-responsive img-thumbnail" src="../images/$forumInfo.jpg">
                <strong><a href="#">随笔</a></strong>
                <p class='text-danger'>用户说明</p>

            </div>
        </div>
    </div>

</div>
              </div>
            </div>
        </div>
        <!-- 右侧 -->
        <div class="col-xs-3 div_record">
            <!-- 用户信息 -->
            <div class=" div_userinfo">
                <img class="img-responsive img-thumbnail" src="../images/$forumInfo.jpg">
            </div>
            <!-- 随手记录 -->
            <div class="blog-sidebar-widget blog-bor">
                <h2 class="blog-text-center blog-title" style="opacity: 0.6;"><span>$user.username</span></h2>
            <p> 
            #if($user.signature)
            $user.signature
            #else
            您未设置个人说明
            #end
			</p>
            </div>
            <div id=failedInfo class="alert alert-warning"  >
                <a href="#" class="close" data-dismiss="alert">&times;</a>
                <strong id="failedmsg">好友的信息！</strong>
            </div>
            <div id="successInfo" class="alert alert-success"  >
                <a href="#" class="close" data-dismiss="alert">&times;</a>
                <strong id="successmsg">好友的信息！</strong>
            </div>
            <textarea class="form-control" rows="3" name=textarea placeholder="随笔写点什么吧"></textarea>
            <br>
            <div class="div_save">
                <button type="button" class="btn btn-primary btn_save_record">save</button>
            </div>
            <hr>

        </div>
    </div>
    <!-- 登录模态框 -->
    <div class="modal fade bs-example-modal-sm" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title" id="myModalLabel" style="text-align: center;">登录</div>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" style="padding: 12px;">
                        <div class="form-group">
                            <input type="text" class="form-control" id="inputEmail3" placeholder="账户名">
                        </div>
                        <div class="form-group">
                            <input type="password" class="form-control" id="inputPassword3" placeholder="密码">
                        </div>
                    </form>
                </div>
                <div class="modal-footer" style="text-align: center;">
                    <button type="button" class="btn btn-primary" style="width: 100%">Login</button>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="../js/jquery-3.3.1.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/amazeui.min.js"></script>
<script type="text/javascript">
	$(function(){
		getMyHomePage(1);
		addInfo();
	})
	function getInfo(){
		return localStorage.getItem("Authorization");
	}
	function getMyHomePage(page){
		if(null==page||page<1)
			page=1;
		var pagesize=6;
		$.ajax({
			type:'post',
			url:'../base/insForumPageInfo',
			dataType:'json',
			data:{"userid":$('#userid').val(),"pagesize":pagesize},
			success:function(data){
				console.log(data);
			}
		})
	}
	function addInfo(){
		var uname=$('#uname').val();
		var uid=$('#userid').val();
		var info=localStorage.getItem("Authorization");
		$("a[name='toEdit']").attr("href","../user/toEditMe?uname="+uname+"&uid="+uid+"&info="+info);
		$("a[name='mycomment']").attr("href","../user/myComment?uid="+uid+"&uname="+uname+"&info="+info);
		$('#myforuma').attr("href","../user/myHome?uid="+uid+"&uname="+uname+"&info="+info);
		
	
	}
	 function showMyCollect(page){
			var info=getInfo();
			var uid=$('#userid').val();
			if(null==page||page<1)
				page=1;
			if(null!=info){
				$.ajax({
					type:'post',
					url:'../jwt/getCollectForum',
					contentType:'application/json;charset=utf-8',
					dataType:'json',
					headers:{
						Authorization:info
					},
					data:JSON.stringify({"currentpage":page,"userid":uid}),
					success:function(resp){
						if(resp.list.length<=1){
							$('#forumdiv').empty();
							$('#someinfo').html("我的收藏");
							$('#forumdiv').append("<h3 class='text-danger'>未找到有关记录,先去收藏一个</h3>");
						}else{
						
						for(var i=0;i<resp.list.length;i++){
								var ucf=resp.list[i];
							
							$('#forumdiv').empty()
							$('#forumdiv').append("<article class='am-g blog-entry-article'><div class='am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-img'><img src='"+ucf.image+"'alt=''class='am-u-sm-12'></div><div class='am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-text'><span><a href='../ins/"+ucf.institutionid+"'class='blog-color'>"+ucf.institutionname+"&nbsp;</a></span><span><a href='../user/otherUser?uid="+ucf.authorid+"&info="+info+"'>@--"+ucf.authorname+"&nbsp;</a></span><span>"+ucf.createtime+"</span><br><strong><a href='../p/"+ucf.forumid+"'>"+ucf.title+"</a></strong><p>"+ucf.description+"</p><p><a href=''class='blog-continue'>continue reading</a></p></div></article>");
							$('#someinfo').html("我的收藏");
							}
						}
					}
				})
			}
	 }
</script>
<script>
    function showMenu() {
        document.getElementById('dropMenu').style.display = 'block';
    }

    function hideMenu() {
        document.getElementById('dropMenu').style.display = 'none';
    }
    function logOut(){
		localStorage.removeItem("Authorization");
		$.ajax({
			type:'post',
			url:'../logout',
			success:function(){
				window.location.reload();
			}
		})
	}
</script>
</body>
</html>