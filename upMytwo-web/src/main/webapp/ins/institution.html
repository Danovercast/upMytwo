<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>信息工程学院板块</title>
<link href="../css/bootstrap.min.css" rel="stylesheet">
<!-- Font Awesome -->
<link href="../_css/font-awesome.min.css" rel="stylesheet">
<!-- bootstrap-wysiwyg -->
<link href="../_css/prettify.min.css" rel="stylesheet">
<!-- Select2 -->
<link href="../_css/select2.min.css" rel="stylesheet">
<!-- Switchery -->
<link href="../_css/switchery.min.css" rel="stylesheet">
<link href="../_css/custom.min.css" rel="stylesheet">
<!-- starrr -->
<link href="../_css/starrr.css" rel="stylesheet">
<script src="../js/jquery-1.11.3.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script type="text/javascript"></script>
</head>
<script>
	function submitForum() {
		$("#submitForum").submit();
	}
</script>
<!--滚动隐藏顶部链接-->
<script type="text/javascript">
	window.onscroll = function() {
		var dis = document.documentElement.scrollTop || document.body.scrollTop;
		var scrollup = document.getElementById("upUl");
		if (dis > 80) {
			scrollup.style.display = "none";
		} else {
			scrollup.style.display = "block";
		}
	}
</script>
<style>
.UPLI {
	width: 12.5%;
}

.blog-post {
	margin: 0.5cm;
}

.blog-post:hover {
	background-color: #5FB878;
}

#toShare {
	position: fixed;
	bottom: 240px;
	right: 120px;
	border-radius: 15px;
	text-align: center;
}

.updiv:hover {
	background-color: #99CCFF;
}

#toHeader {
	position: fixed;
	bottom: 80px;
	right: 120px;
	border-radius: 15px;
	text-align: center;
}

#toHome {
	position: fixed;
	bottom: 160px;
	right: 120px;
	border-radius: 15px;
	text-align: center;
}

#releaseForum {
	position: fixed;
	bottom: 400px;
	right: 110px;
}

.awayTop {
	margin-top: 20px;
}
</style>
<body>
	<div class="bs-example" id="upUl"
		data-example-id="simple-nav-justified">
		
		<ul class="nav nav-tabs nav-justified">
			<li role="presentation"><a href="#">我的</a></li>
			<li role="presentation"><a href="#">修改信息</a></li>
			<li role="presentation"><a href="#">我的好友</a></li>
			<li role="presentation"><a href="#" id="loga">退出</a></li>
		</ul>
		<br>
		<ul class="nav nav-pills nav-justified" id="ul1">

		</ul>
		<br>
		<ul class="nav nav-pills nav-justified" id="ul2">

		</ul>
		<br>
		<ul class="nav nav-pills nav-justified" id="ul3">

		</ul>
	</div>
<a id="topa"></a>

	<div class="row" style="height: 80px"></div>
	<div class="row"
		style="height: 200px; background-color: #5bc0de; width: 60%; margin-left: 20%">
		<div id="myCarousel" class="carousel slide">
			<!-- 轮播（Carousel）指标 -->
			<ol class="carousel-indicators">
				<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				<li data-target="#myCarousel" data-slide-to="1"></li>
				<li data-target="#myCarousel" data-slide-to="2"></li>
			</ol>
			<!-- 轮播（Carousel）项目 -->
			<div class="carousel-inner">
				<div class="item active">
					<img src="../i/bailu.jpg" style="width: 100%; max-height: 200px"
						alt="First slide">
				</div>
				<div class="item">
					<img src="../i/blossoms2.jpg"
						style="width: 100%; max-height: 200px" alt="Second slide">
				</div>
				<div class="item">
					<img src="../i/ice.jpg" style="width: 100%; max-height: 200px"
						alt="Third slide">
				</div>
			</div>
			<!-- 轮播（Carousel）导航 -->
			<a class="left carousel-control" href="#myCarousel" role="button"
				data-slide="prev"> <span
				class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
				<span class="sr-only">Previous</span>
			</a> <a class="right carousel-control" href="#myCarousel" role="button"
				data-slide="next"> <span
				class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
				<span class="sr-only">Next</span>
			</a>
		</div>
	</div>
	<div class="container">



		<div class="row">

			<div class="col-sm-8 blog-main">


				<div class="">

					<h2 class="blog-post-title" style="text-align: center;">信息工程学院置顶</h2>
					<p class="blog-post-meta">
						December 23, 2013 by <a href="#">Dacob</a>
					</p>
					<blockquote>
						<li><a href="#">信息工程学院置顶帖链接</a></li>
						<p>
							这里是信息工程学院分类贴. <strong>并非限制区域发帖 只是方便查看</strong> 可以自行选择发帖区域 和 类型.
						</p>
					</blockquote>

				</div>

				<div class="" id="forumContent">
					<div class="blog-post"
						style="border: 2px solid #d5dbe2; border-radius: 3px">
						<div style="margin: 1cm;">
							<h3 class="blog-post-title">forum title</h3>
							<hr>
							<p class="blog-post-meta">
								December 14, 2013 by <a href="#">Chris</a>
							</p>

							<li><a href="#">发帖链接</a></li>
							<p>
								Curabitur blandit tempus porttitor. <strong>Nullam quis
									risus eget urna mollis</strong> ornare vel eu leo. Nullam id dolor id
								nibh ultricies vehicula ut id elit.
							</p>

						</div>
					</div>
				</div>
				<nav>
					<ul class="pager" id="pageul">
					</ul>
				</nav>
				<div class="col-md-12 col-sm-12 col-xs-12">
					<div class="x_panel">
						<div class="x_title">
						<a id="sendForum"></a>
							<h2>
								发布信息<small>信息工程学院</small>
							</h2>
							 
							<div class="clearfix"></div>

						</div>
						<div class="x_title">

							<div id="alerts"></div>
							<div class="x_content"></div>
							<div class="form-group ">


								<div class="col-sm-12" style="marring-left: 80px">
									<div class="input-group">
										<span class="input-group-btn">
											<button type="button" class="btn btn-primary">title</button>
										</span> <input type="text" class="form-control" id="title">
									</div>

								</div>
							</div>
							<div class="btn-toolbar editor" data-role="editor-toolbar"
								data-target="#editor-one">
								<div class="btn-group">
									<a class="btn dropdown-toggle" data-toggle="dropdown"
										title="Font"><i class="fa fa-font"></i><b class="caret"></b></a>
									<ul class="dropdown-menu">
									</ul>
								</div>

								<div class="btn-group">
									<a class="btn dropdown-toggle" data-toggle="dropdown"
										title="Font Size"><i class="fa fa-text-height"></i>&nbsp;<b
										class="caret"></b></a>
									<ul class="dropdown-menu">
										<li><a data-edit="fontSize 5">
												<p style="font-size: 17px">Huge</p>
										</a></li>
										<li><a data-edit="fontSize 3">
												<p style="font-size: 14px">Normal</p>
										</a></li>
										<li><a data-edit="fontSize 1">
												<p style="font-size: 11px">Small</p>
										</a></li>
									</ul>
								</div>

								<div class="btn-group">
									<a class="btn" data-edit="bold" title="Bold (Ctrl/Cmd+B)"><i
										class="fa fa-bold"></i></a> <a class="btn" data-edit="italic"
										title="Italic (Ctrl/Cmd+I)"><i class="fa fa-italic"></i></a> <a
										class="btn" data-edit="strikethrough" title="Strikethrough"><i
										class="fa fa-strikethrough"></i></a> <a class="btn"
										data-edit="underline" title="Underline (Ctrl/Cmd+U)"><i
										class="fa fa-underline"></i></a>
								</div>

								<div class="btn-group">
									<a class="btn" data-edit="insertunorderedlist"
										title="Bullet list"><i class="fa fa-list-ul"></i></a> <a
										class="btn" data-edit="insertorderedlist" title="Number list"><i
										class="fa fa-list-ol"></i></a> <a class="btn" data-edit="outdent"
										title="Reduce indent (Shift+Tab)"><i class="fa fa-dedent"></i></a>
									<a class="btn" data-edit="indent" title="Indent (Tab)"><i
										class="fa fa-indent"></i></a>
								</div>

								<div class="btn-group">
									<a class="btn" data-edit="justifyleft"
										title="Align Left (Ctrl/Cmd+L)"><i
										class="fa fa-align-left"></i></a> <a class="btn"
										data-edit="justifycenter" title="Center (Ctrl/Cmd+E)"><i
										class="fa fa-align-center"></i></a> <a class="btn"
										data-edit="justifyright" title="Align Right (Ctrl/Cmd+R)"><i
										class="fa fa-align-right"></i></a> <a class="btn"
										data-edit="justifyfull" title="Justify (Ctrl/Cmd+J)"><i
										class="fa fa-align-justify"></i></a>
								</div>

								<div class="btn-group">
									<a class="btn dropdown-toggle" data-toggle="dropdown"
										title="Hyperlink"><i class="fa fa-link"></i></a>
									<div class="dropdown-menu input-append">
										<input class="span2" placeholder="URL" type="text"
											data-edit="createLink" />
										<button class="btn" type="button">Add</button>
									</div>
									<a class="btn" data-edit="unlink" title="Remove Hyperlink"><i
										class="fa fa-cut"></i></a>
								</div>

								<div class="btn-group">
									<a class="btn" title="Insert picture (or just drag & drop)"
										id="pictureBtn"><i class="fa fa-picture-o"></i></a> <input
										type="file" data-role="magic-overlay"
										data-target="#pictureBtn" data-edit="insertImage" />
								</div>

								<div class="btn-group">
									<a class="btn" data-edit="undo" title="Undo (Ctrl/Cmd+Z)"><i
										class="fa fa-undo"></i></a> <a class="btn" data-edit="redo"
										title="Redo (Ctrl/Cmd+Y)"><i class="fa fa-repeat"></i></a>
								</div>
							</div>

							<div id="editor-one" class="editor-wrapper"></div>

							<textarea name="comment" id="descr" style="display: none;"> </textarea>

							<br />

							<div class="ln_solid"></div>

							<a href="#" class="btn btn-primary btn-lg  "
								style="float: right; margin-right: 50px" onclick="releaseforum()">发布</a>
						</div>
					</div>
				</div>
			</div>
			<!-- /.blog-main -->

			<div class="col-sm-3 col-sm-offset-1 blog-sidebar">
				<div class="sidebar-module sidebar-module-inset">
					<h4>About</h4>
					<p>南昌航空大学是一所以工为主，工、理、文、管、经、法、教、艺等学科协调发展的多科性大学。学校是江西省人民政府与国家国防科技工业局共建的高等学校，是教育部第二批卓越工程师教育培养计划实施高校，是“中国政府奖学金”来华留学生培养院校，是教育部本科教学工作水平评估优秀高校。.</p>
				</div>
				<div class="sidebar-module sidebar-module-inset "
					style="border: 1px dashed #f3e97a; border-radius: 10px">
					<h4 class="text-info text-center">院内搜索</h4>
					<div class="form-group text-center">
						<label class="sr-only" for="name">名称</label> <input type="text"
							class="form-control" id="name" placeholder="请输入名称">
						<button class="btn btn-info  awayTop">search</button>
					</div>
				</div>
				<div class="sidebar-module">
					<h4>Archives</h4>
					<ol class="list-unstyled" id="institutionOl">
						 
						<li>
							<div class="col-md-55">
								<div class="thumbnail">
									<div class="image view view-first">
										<img style="width: 100%; display: block;"
											src="picture/bailu.jpg" alt="image" />
										<div class="mask">
											<p>Your Text</p>

										</div>
									</div>
									<div class="caption">
										<p>Snow and Ice Incoming for the South</p>
									</div>
								</div>
							</div>
						</li>


					</ol>
				</div>
				<div class="sidebar-module">
					<h4>Elsewhere</h4>
					<ol class="list-unstyled">
						<li><a href="#">北京大学</a></li>
						<li><a href="#">清华大学</a></li>
						<li><a href="#">南航</a></li>
					</ol>

				</div>





			</div>
			<!-- /.blog-sidebar -->

		</div>
		<!-- /.row -->

	</div>
	<!-- /.container -->
<!-- 发贴时回显信息 -->
	<div class="modal fade" id="releaseForumInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" 
						aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					未选择学院
				</h4>
			</div>
			<div class="modal-body" id="releaseForumResult">
				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" 
						data-dismiss="modal">关闭
				</button>
				<a href="#" type="button" class="btn btn-primary" id="gotoforum" target="_blank">
					立即查看
				</a>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div>
	<!-- 发贴时回显信息 -->

	<nav class="navbar navbar-default navbar-static-top" id="bottomlogin">
	
		<div class="alert alert-info" role="alert">
			<b>当你没有登陆时你可能看到下面这样的信息</b>
		</div>
		<form class="form-inline">
			<div class="form-group">
				<label class="sr-only" for="exampleInputEmail3">Email
					address</label> <input type="email" class="form-control"
					id="exampleInputEmail3" placeholder="Email">
			</div>
			<div class="form-group">
				<label class="sr-only" for="exampleInputPassword3">Password</label>
				<input type="password" class="form-control"
					id="exampleInputPassword3" placeholder="Password">
			</div>
			<div class="checkbox">
				<label> <input type="checkbox"> Remember me
				</label>
			</div>
			<button type="submit" class="btn btn-default">Sign in</button>
		</form>


	</nav>
	<button class="btn-success btn btn-lg" id="toShare" value="sh"
		title="分享"  >
		<b>sh</b>
	</button>
	<a class="btn-success btn  btn-lg" id="toHome" href="../html/index.html" target="_blank" value="sh"
		title="回到首页"  >
		<b>sh</b>
	</a>


	<a href="#sendForum" id="releaseForum" type="button" class="btn btn-primary">发帖</a>

	<a class="btn-success btn btn-lg" id="toHeader" value="up"
		title="回到顶部"  href="#topa">
		<b>sh</b>
	</a>
	<!-- FastClick -->
	<script src="../_js/fastclick.js"></script>
	<!-- bootstrap-wysiwyg -->
	<script src="../_js/bootstrap-wysiwyg.min.js"></script>
	<script src="../_js/jquery.hotkeys.js"></script>
	<script src="../_js/prettify.js"></script>
	<!-- jQuery Tags Input -->
	<script src="../_js/jquery.tagsinput.js"></script>
	<!-- Switchery -->
	<script src="../_js/switchery.min.js"></script>
	<!-- Select2 -->
	<script src="../_js/select2.full.min.js"></script>
	<!-- Parsley -->
	<script src="../_js/parsley.min.js"></script>
	<!-- Autosize -->
	<script src="../_js/autosize.min.js"></script>
	<!-- starrr -->
	<script src="../_js/starrr.js"></script>
	<!-- Custom Theme Scripts -->
	<script src="../_js/custom.min.js"></script>
	<script type="text/javascript">
		$(function() {
			var currentpage = 1;
			var pagesize = 8;
			var institutionid = 1;
			var pageinfo = JSON.stringify({
				"currentpage" : currentpage,
				"pagesize" : pagesize,
				"institutionid" : 1
			});
			var token = localStorage.getItem("Authorization");
			if (null != token) {
				$('#bottomlogin').hide();

			} else {
				$('#loga').html("登陆")
				$('#loga').attr("href", "#bottomlogin")
			}
			insForumPageInfo(1, 6);
			getUserInfo();
			alert()
			$.ajax({
						type : 'post',
						url : '../forum/institutionForumList',
						contentType : 'application/json;charset=utf-8',
						data : pageinfo,
						dataType : 'json',
						success : function(data) {
							console.log(data)
							for (var i = 0; i < data.length; i++) {
								$('#forumContent')
										.append(
												"<div class='blog-post'style='border: 2px solid #d5dbe2; border-radius: 3px'><div style='margin: 1cm;'><a href='../p/"+data[i].forumid+"' target='_blank' ><h3 class='blog-post-title'>"
														+ data[i].title
														+ "</h3></a><hr><p class='blog-post-meta'>"
														+ data[i].createtime
														+ " by    @<a href='../user/"+data[i].authorid+"'>"
														+ data[i].authorname
														+ "</a></p><li><a href='../p/"+data[i].forumid+"'>"
														+ data[i].title
														+ "</a></li><p>"
														+ data[i].description
														+ "</p></div></div>");
							}
							institutionInfoList();
						}
					})
					
					
		})
		function institutionInfoList() {
			var currentpage = 1;
			var pagesize = 6;
			var pageinfo = JSON.stringify({
				"currentpage" : currentpage,
				"pagesize" : pagesize
			})
			$
					.ajax({
						type : 'post',
						url : '../base/institutionInfoList',
						contentType : 'application/json;charset=utf-8',
						data : pageinfo,
						dataType : 'json',
						success : function(data) {
							console.log(data)
							var count = 0;
							for (var i = 0; i < data.length; i++) {
								$('#institutionOl')
										.append(
												"<li><div class='col-md-55'><div class='thumbnail'><div class='image view view-first'><img style='width: 100%; display: block;'src='"
														+ data[i].image
														+ "'alt='image'/><div class='mask'><p>"
														+ data[i].institutionname
														+ "</p></div></div><div class='caption'><a href='../ins/"+data[i].institutionid+"'target='_blank'><p>"
														+ data[i].description
														+ "</p></a></div></div></div></li>");
								if (i % 3 === 0 && i < data.length) {
									count = count + 1;
									$('#ul' + count).append(
											"<li role='presentation' class=''><a href='../ins/"+data[i].institutionid+"'>"
													+ data[i].institutionname
													+ "</a></li>");
								} else {
									$('#ul' + count).append(
											"<li role='presentation' class=''><a href='../ins/"+data[i].institutionid+"'>"
													+ data[i].institutionname
													+ "</a></li>");
								}
							}
						}
					})
		}
		function insForumPageInfo(currentpage, pagesize) {

			if (currentpage < 1 || pagesize < 1) {
				var currentpage = 1;
				var pagesize = 6;
			}
			var institutionid = 1;
			$.ajax({
				type : 'post',
				url : '../base/insForumPageInfo',
				data : {
					"currentpage" : currentpage,
					"pagesize" : pagesize,
					"institutionid" : institutionid
				},
				dataType : 'json',
				success : function(pageinfo) {
					console.log(pageinfo)
					for (var i = 1; i <= pageinfo.totalpage; i++) {
						if (i === 1) {
							$('#pageul').append(
									" <li><a href='javascript:void(0)' onclick='changepage("
											+ pageinfo.currentpage
											+ ")'>Previous</a></li>");
						}
						$('#pageul').append(
								" <li class='active'><a href='javascript:void(0)' onclick='changepage("
										+ i + ")'>" + i + "</a></li>");
						if (i === pageinfo.totalpage) {
							$('#pageul').append(
									" <li class='active'><a href='javascript:void(0)' onclick='changepage("
											+ i + ")'>Next</a></li>");
						}
					}
				}
			})
		}
		function insPageForum(currentpage) {
			if (currentpage === null || currentpage < 1)
				currentpage = 1

		}
		function changepage(page) {
			if (page < 1) {

			} else {
				var inid = 1;
				var pagesize = 6;
				var data = {
					"institutionid" : inid,
					"currentpage" : page,
					"pagesize" : pagesize
				};
				$
						.ajax({
							type : 'post',
							url : '../forum/institutionForumList',
							data : JSON.stringify(data),
							contentType : 'application/json;charset=utf-8',
							dataType : 'json',
							success : function(list) {
								console.log(list)
								$('#forumContent').empty();
								for (var i = 0; i < list.length; i++) {
									$('#forumContent')
											.append(
													"<div class='blog-post'style='border: 2px solid #d5dbe2; border-radius: 3px'><div style='margin: 1cm;'><a href='../p/"+list[i].forumid+"' target='_blank' ><h3 class='blog-post-title'>"
															+ list[i].title
															+ "</h3></a><hr><p class='blog-post-meta'>"
															+ list[i].createtime
															+ " by    @<a href='../user/"+list[i].authorid+"'>"
															+ list[i].authorname
															+ "</a></p><li><a href='../p/"+list[i].forumid+"'>"
															+ list[i].title
															+ "</a></li><h2><p>"
															+ list[i].description
															+ "</p></h2></div></div>");
								}
							}
						})
			}

		}
		function releaseforum(){
			var title = $('#title').val();
			var description = $('#editor-one').html();
			var jsonD = {
				"title" : title,
				"description" : description,
				"institution_id":1,
			};
			var jsonDD = JSON.stringify(jsonD);
			var token=localStorage.getItem("Authorization");
			if(token===null){
				$('#releaseForumInfo').modal("show")
				$('#myModalLabel').html("请求未发送");
				$('#gotoforum').html("去登陆");
				$('#releaseForumResult').html("验证信息失败,请登陆后重试");
				$('#gotoforum').attr("href","../html/login.html")
			}else{
				
			
			$.ajax({
				type : "post",
				url : "../jwt/releaseForum",
				contentType : "application/json;charset=utf-8",
				dataType:'json',
				data : jsonDD, 
				headers:{
					Authorization:token
				},
				success : function(data){
					$('#releaseForumInfo').modal('show');
					$('#releaseForumResult').html(data.msg);
					$('#myModalLabel').html("请求已发送");
					$('#title').val('');
					if(data.code===3){
						$('#gotoforum').html("去登陆");
						$('#gotoforum').attr("href","../html/login.html")
					}
					if(data.code===1){
						$('#gotoforum').html("查看");
						$('#editor-one').html('')
						$('#gotoforum').attr("href","../p/"+data.data)
					}
					console.log(data)
				}
			})
			}
		}
		function getUserInfo(){
			alert(0)
			var token=localStorage.getItem("Authorization");
			console.log(token)
			if(null!=token){
				$.ajax({
					type:'post',
					url:'../base/userInfo',
					heeaders:{
						Authorization:token
					},
					success:function(resp){
						if(resp.code!=1){
							console.log("---------"+resp);
						}else{
							console.log(resp);
						}
					}
					
				})
			}
		}
	</script>

</body>
</html>